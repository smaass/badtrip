<!DOCTYPE html>
<!-- saved from url=(0042)http://butterchurn.neocities.org/demo.html -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Bad Trip</title>
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
                m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
                                })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    </script>

    <link rel="stylesheet" href="./demo.css">

    <!-- <link rel="stylesheet" href="js/lib/codemirror-3.18/lib/codemirror.css"> -->

    <script type="text/javascript" src="./js/presetbase.js"></script>
    <script type="text/javascript" src="./js/app.js"></script><style type="text/css"></style><script type="x-shader/x-vertex" id="vertShader">
varying vec2 vUv;

void main() {
    vUv = uv;
    gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}
</script>

<script type="x-shader/x-fragment" id="warpFShaderStart">

vec3 saturate(vec3 v){
    return clamp(v, 0.0, 1.0);
}

vec3 lum(vec3 v){
    return vec3(dot(v, vec3(0.32,0.49,0.29)));
}

uniform float time;
uniform float decay;
uniform float bass;
uniform float mid;
uniform float treb;
uniform float vol;
uniform float bass_att;
uniform float mid_att;
uniform float treb_att;
uniform float vol_att;

uniform float frame;
uniform float fps;

uniform float q1;
uniform float q2;
uniform float q3;
uniform float q4;
uniform float q5;
uniform float q6;
uniform float q7;
uniform float q8;
uniform float q9;
uniform float q10;
uniform float q11;
uniform float q12;
uniform float q13;
uniform float q14;
uniform float q15;
uniform float q16;
uniform float q17;
uniform float q18;
uniform float q19;
uniform float q20;
uniform float q21;
uniform float q22;
uniform float q23;
uniform float q24;
uniform float q25;
uniform float q26;
uniform float q27;
uniform float q28;
uniform float q29;
uniform float q30;
uniform float q31;
uniform float q32;

uniform vec4 _qa;
uniform vec4 _qb;
uniform vec4 _qc;
uniform vec4 _qd;
uniform vec4 _qe;
uniform vec4 _qf;
uniform vec4 _qg;
uniform vec4 _qh;

uniform vec4 slow_roam_cos;
uniform vec4 roam_cos;
uniform vec4 slow_roam_sin;
uniform vec4 roam_sin;

uniform vec2 resolution;
uniform vec4 aspect;

uniform vec4 texsize;
uniform vec4 texsize_noise_lq;
uniform vec4 texsize_noise_mq;
uniform vec4 texsize_noise_hq;
uniform vec4 texsize_noise_lq_lite;

uniform float blur1_min;
uniform float blur1_max;
uniform float blur2_min;
uniform float blur2_max;
uniform float blur3_min;
uniform float blur3_max;

uniform float scale1;
uniform float scale2;
uniform float scale3;
uniform float bias1;
uniform float bias2;
uniform float bias3;

uniform vec4 rand_frame;
uniform vec4 rand_preset;

uniform int darken_center;
uniform sampler2D chan0;
uniform sampler2D sampler_main;
uniform sampler2D sampler_fw_main;
uniform sampler2D sampler_fc_main;
uniform sampler2D sampler_pw_main;
uniform sampler2D sampler_pc_main;
uniform sampler2D sampler_blur1;
uniform sampler2D sampler_blur2;
uniform sampler2D sampler_blur3;
uniform sampler2D sampler_noise_lq;
uniform sampler2D sampler_noise_lq_lite;
uniform sampler2D sampler_noise_mq;
uniform sampler2D sampler_noise_hq;
//uniform sampler3D sampler_noisevol_lq;
//uniform sampler3D sampler_noisevol_hq;
float PI = 3.14159265358979323846264;

varying vec2 vUv;

void main(void)
{
    vec2 uv = vUv;
    vec2 uv_orig  = gl_FragCoord.xy / resolution.xy;
    float rad = length(uv_orig - 0.5);
    float ang = atan(uv_orig.y - 0.5, uv_orig.x - 0.5);
    vec3 ret;

    // Access sampler_main, because blur chans get messed up for some reason if it is never accessed
    vec3 tmpderp  = texture2D(sampler_main,vUv).rgb;

</script>

<script type="x-shader/x-fragment" id="warpFShaderEnd">

    //Darken Center
    float darken_rad = 0.05;
    if(darken_center == 1 &&
       rad < darken_rad) {
       ret = mix(ret, vec3(0.0,0.0,0.0),(1.0 - rad/darken_rad) * 3.0 / 32.0);
    }

    gl_FragColor = vec4(ret, 1.0);
}
</script>

<script type="x-shader/x-fragment" id="warpFShaderCompatibility">
// sample previous frame
ret = texture2D(sampler_main,vUv).rgb;

// darken (decay) over time
ret *= decay;  //or try: ret -= 0.004;
</script>

<script type="x-shader/x-fragment" id="compositeFShaderStart">

vec3 saturate(vec3 v){
    return clamp(v, 0.0, 1.0);
}

vec3 lum(vec3 v){
    return vec3(dot(v, vec3(0.32,0.49,0.29)));
}

vec3 calc_hue(vec3 hue_base[ 4 ], vec2 uv) {
    vec3 tA = mix( hue_base[0], hue_base[1], uv.x );
    vec3 tB = mix( hue_base[2], hue_base[3], uv.x );
    return mix( tA, tB, uv.y );
}

uniform float time;
uniform float gammaAdj;
uniform float echo_zoom;
uniform float echo_alpha;
uniform float echo_orientation;
uniform int invert;
uniform int brighten;
uniform int darken;
uniform int solarize;
uniform vec2 resolution;
uniform vec4 aspect;

uniform float bass;
uniform float mid;
uniform float treb;
uniform float vol;
uniform float bass_att;
uniform float mid_att;
uniform float treb_att;
uniform float vol_att;

uniform float frame;
uniform float fps;

uniform float q1;
uniform float q2;
uniform float q3;
uniform float q4;
uniform float q5;
uniform float q6;
uniform float q7;
uniform float q8;
uniform float q9;
uniform float q10;
uniform float q11;
uniform float q12;
uniform float q13;
uniform float q14;
uniform float q15;
uniform float q16;
uniform float q17;
uniform float q18;
uniform float q19;
uniform float q20;
uniform float q21;
uniform float q22;
uniform float q23;
uniform float q24;
uniform float q25;
uniform float q26;
uniform float q27;
uniform float q28;
uniform float q29;
uniform float q30;
uniform float q31;
uniform float q32;

uniform vec4 _qa;
uniform vec4 _qb;
uniform vec4 _qc;
uniform vec4 _qd;
uniform vec4 _qe;
uniform vec4 _qf;
uniform vec4 _qg;
uniform vec4 _qh;

uniform vec4 slow_roam_cos;
uniform vec4 roam_cos;
uniform vec4 slow_roam_sin;
uniform vec4 roam_sin;

uniform vec4 texsize;
uniform vec4 texsize_noise_lq;
uniform vec4 texsize_noise_mq;
uniform vec4 texsize_noise_hq;
uniform vec4 texsize_noise_lq_lite;

uniform float blur1_min;
uniform float blur1_max;
uniform float blur2_min;
uniform float blur2_max;
uniform float blur3_min;
uniform float blur3_max;

uniform float scale1;
uniform float scale2;
uniform float scale3;
uniform float bias1;
uniform float bias2;
uniform float bias3;

uniform vec4 rand_frame;
uniform vec4 rand_preset;

uniform sampler2D sampler_main;
uniform sampler2D sampler_fw_main;
uniform sampler2D sampler_fc_main;
uniform sampler2D sampler_pw_main;
uniform sampler2D sampler_pc_main;
uniform sampler2D sampler_blur1;
uniform sampler2D sampler_blur2;
uniform sampler2D sampler_blur3;
uniform sampler2D sampler_noise_lq;
uniform sampler2D sampler_noise_lq_lite;
uniform sampler2D sampler_noise_mq;
uniform sampler2D sampler_noise_hq;
//uniform sampler3D sampler_noisevol_lq;
//uniform sampler3D sampler_noisevol_hq;
uniform vec3 hue_base[ 4 ];
uniform float fShader;
float PI = 3.14159265358979323846264;

varying vec2 vUv;

void main(void)
{
    vec2 uv = vUv;
    vec2 uv_orig = vUv;
    float rad = length(uv - 0.5);
    float ang = atan(uv.y - 0.5, uv.x - 0.5);
    vec3 ret;

    vec3 hue_shader = calc_hue(hue_base, vUv);

</script>

<script type="x-shader/x-fragment" id="compositeFShaderEnd">

    //ret = pow(ret, vec3( 1.0 / 2.2 )); //gamma correct

    gl_FragColor = vec4(ret,1.0);
}

</script>

<script type="x-shader/x-fragment" id="compositeFShaderCompatibility">

float orient_x = (mod(echo_orientation, 2.0) > 0.0) ? -1.0 : 1.0;
float orient_y = (echo_orientation >= 2.0) ? -1.0 : 1.0;
vec2 uv_echo = (uv - 0.5)*(1.0 / echo_zoom)*vec2(orient_x, orient_y) + 0.5;

ret = mix( texture2D(sampler_main, uv).rgb,
           texture2D(sampler_main, uv_echo).rgb,
           echo_alpha); //video echo

ret *= gammaAdj; //gamma

if(fShader >= 1.0) {
    ret *= hue_shader; //old hue shader effect
}
else if(fShader > 0.001) {
    ret *= (1.0 - fShader) + fShader*hue_shader;
}

if(invert > 0) ret = 1.0 - ret;
if(brighten > 0) ret = sqrt(ret);
if(darken > 0) ret = ret*ret;
if(solarize > 0) ret = ret * (1.0 - ret) * 4.0;
</script>

    <script type="text/javascript" src="./js/demo.js"></script>

</head>
<body>

    <div id="mainWrapper" style="display: block;">

        <div id="staticinfo">
            <h1>Use headphones!</h1>
            <br>
            Press m to maximize within window
            <br>
            Press f or double click for full screen
        </div>
        <div id="container">
            <div id="canvaswrapper" style="margin: auto; width: 800px;">
            </div>
        </div>
    </div>
</body>
</html>